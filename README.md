# sensit-php

Official Sensit API library client for PHP

__This library is generated by [alpaca](https://github.com/pksunkara/alpaca)__

## Installation

Make sure you have [composer](https://getcomposer.org) installed.

Add the following to your composer.json

```js
{
    "require": {
        "cwadding/sensit-client": "*"
    }
}
```

Update your dependencies

```bash
$ php composer.phar update
```

> This package follows the `PSR-0` convention names for its classes, which means you can easily integrate these classes loading in your own autoloader.

#### Versions

Works with [ 5.4 / 5.5 ]

## Usage

```php
<?php

// This file is generated by Composer
require_once 'vendor/autoload.php';

// Then we instantiate a client (as shown below)
```

### Build a client

##### Without any authentication

```php
$client = new Sensit\Client();

// If you need to send options
$client = new Sensit\Client(array(), $options);
```

##### Authorization header token

```php
$client = new Sensit\Client('1a2b3', $options);
```

### Response information

```php
$response = $client->klass('args')->method('args');

$response->body;
// >>> 'Hello world!'

$response->code;
// >>> 200

$response->headers;
// >>> array('content-type' => 'text/html')
```
##### HTML response

```php
$response->body;
// >>> 'The username is pksunkara!'
```

##### JSON response

```php
$response->body;
// >>> array('user' => 'pksunkara')
```

### Request body information

##### RAW request

```php
$body = 'username=pksunkara';
```

##### FORM request

```php
$body = array('user' => 'pksunkara');
```

##### JSON request

```php
$body = array('user' => 'pksunkara');
```

### Client Options

The following options are available while instantiating a client:

 * __base__: Base url for the api
 * __api_version__: Default version of the api (to be used in url)
 * __user_agent__: Default user-agent for all requests
 * __headers__: Default headers for all requests
 * __request_type__: Default format of the request body

### Method Options

The following options are available while calling a method of an api:

 * __api_version__: Version of the api (to be used in url)
 * __headers__: Headers for the request
 * __query__: Query parameters for the url
 * __body__: Body of the request
 * __request_type__: Format of the request body

### <no value> api

<no value>



```php
$user = $client->user();
```

##### <no value> (GET /user)

<no value>



```php
$response = $user->profile($options);
```

### Topic api

A topic is root that data is attached to. It is the equivalent of a source in searchlight/solink and acts as a table which has columns(Fields) and rows(Feeds).



```php
$topic = $client->topic();
```

##### List of Topics (GET /topics)

Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $topic->list($options);
```

##### Get this Topic (GET /topics/:id)

Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $topic->find($options);
```

##### Create a Topic (POST /topics)

Requires authorization of **manage_any_data**, or **manage_application_data**.

The following arguments are required:

 * __topic__: A hash containing the name/id of the topic (required) and a description of the topic.

```php
$response = $topic->create("{name:'my_topic', description:'Event data from source A.'}", $options);
```

##### Update a Topic (PUT /topics/:id)

Requires authorization of **manage_any_data**, or **manage_application_data**.

The following arguments are required:

 * __topic__: A hash containing the name/id of the topic (required) and a description of the topic.

```php
$response = $topic->update("{name:'my_topic', description:'Event data from source A.'}", $options);
```

##### Delete a Topic (DELETE /topics/:id)

Requires authorization of **manage_any_data**, or **manage_application_data**.



```php
$response = $topic->delete($options);
```

### Feed api

Returns api instance to get auxilary information about Buffer useful when creating your app.

The following arguments are required:

 * __topic_id__: The key for the parent topic
 * __id__: The id of the feed

```php
$feed = $client->feed("1", "my_topic");
```

##### List of Feeds (GET /topics/:topic_id/feeds)

Returns a list of feeds for a given topic. Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $feed->list($options);
```

##### Get a Feed (GET /topics/:topic_id/feeds/:id)

Returns a specific feed for a topic. Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $feed->find($options);
```

##### Create a Feed (POST /topics/:topic_id/feeds)

Create a feed on a given topic. Requires authorization of **read_any_data**, or **read_application_data**.

The following arguments are required:

 * __feed__: A Hash containing `at`: a formatted time of the event. Defaults to the current time if not present.`tz`: The time zone of the time given in `at`. Defaults to UTC`data`:A hash of data to be stored

```php
$response = $feed->create("{at: '2013-02-14T16:13:33.378Z', tz: 'Eastern Time (US & Canada)', data:{key1:123, key2:456.2, city:'alabama'}}", $options);
```

##### Update a Feed (PUT /topics/:topic_id/feeds/:id)

Update an associated Feed to the Topic. Requires authorization of **read_any_data**, or **read_application_data**.

The following arguments are required:

 * __feed__: A hash containing `data`:A hash of data to be stored

```php
$response = $feed->update("{data:{key1:123, key2:456.2, city:'alabama'}}", $options);
```

##### Delete a Feed (DELETE /topics/:topic_id/feeds/:id)

Deletes the desired feed. Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $feed->delete($options);
```

### Get Feed data api

Get the value of a specific field within a feed

The following arguments are required:

 * __topic_id__: The key for the parent topic
 * __feed_id__: The id of the parent feed
 * __id__: The key of the specific field

```php
$data = $client->data("my_topic", "2", "captured_at");
```

##### Get Feed data with a Topic (GET /topics/:topic_id/feeds/:feed_id/data/:id)

Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $data->find($options);
```

##### Update Feed data (PUT /topics/:topic_id/feeds/:feed_id/data/:id)

Update a specific value of a field within a feed with the data passed in. Requires authorization of **read_any_data**, or **read_application_data**.



```php
$response = $data->update($options);
```

### Percolator api

A **Percolator** is a reverse query much like a match rule which is run whenever a new feed is added. These can be used to create alerts by causing the sensit to publish the feed that was just added. A percolator query is defined by a `name` and and valid `query` according to the according the the [elasticsearch Query DSL](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl.html).  For more information about Percolator queries please refer to the [elasticsearch percolator documentation](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-percolate.html).

The following arguments are required:

 * __topic_id__: The key for the parent topic
 * __id__: The name of the percolator query

```php
$percolator = $client->percolator("my_rule", "my_topic");
```

##### List of Percolations for a Topic (GET /topics/:topic_id/percolators)

Returns a list or percolators for a given topic. Requires authorization of **read_any_percolators**, or **read_application_percolators**.



```php
$response = $percolator->list($options);
```

##### Get the Percolator (GET /topics/:topic_id/percolators/:id)

Return a specific percolator of the associated Topic by Id. Requires authorization of **read_any_percolators**, or **read_application_percolators**.



```php
$response = $percolator->find($options);
```

##### Create a Percolator (POST /topics/:topic_id/percolators)

Create a percolator on the associated Topic with the specified name and query. Requires authorization of **manage_any_percolators**, or **manage_application_percolators**.

The following arguments are required:

 * __percolator__: A Hash containing `name`: The name of the percolator(required).`query`: The query hash according to the according the the [elasticsearch Query DSL](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl.html)

```php
$response = $percolator->create("{name: 'Kimchy-User', query:{term: {user: 'kimchy'}}}", $options);
```

##### Update a Percolator (PUT /topics/:topic_id/percolators/:id)

Update the query for a specific percolator. Requires authorization of **manage_any_percolators**, or **manage_application_percolators**.

The following arguments are required:

 * __percolator__: A Hash containing the `query` hash according to the according the the [elasticsearch Query DSL](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl.html)

```php
$response = $percolator->update("{query:{term: {user: 'kimchy'}}}", $options);
```

##### Delete a Percolator (DELETE /topics/:topic_id/percolators/:id)

Delete a percolator on the associated topic. Requires authorization of **manage_any_percolators**, or **manage_application_percolators**.



```php
$response = $percolator->delete($options);
```

### Report api

Reports are stored filter and facet queries on the **Feed** data. A report is a assigned a `name` and the `query` is any elasticsearch query which filters only the desired data for the facets (See the [elasticsearch Query DSL](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-queries.html) for valid queries). A report can have many `facets` with each facet is referred to by a user defined `name`. Valid `type`'s of facet include **terms**, **range**, **histogram**, **filter**, **statistical**, **query**, **terms_stats**, or **geo_distance**. The `query` within a facet defines the field counts or statistics which the data is calculated over. See the [elasticsearch facet dsl](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-facets.html) for information about the various facet types and valid query fields.

The following arguments are required:

 * __topic_id__: The key for the parent topic
 * __id__: The identifier of the report

```php
$report = $client->report("my_report", "my_topic");
```

##### List of Reports for a Topic (GET /topics/:topic_id/reports)

Get all reports for the associated Topic. Requires authorization of **read_any_reports**, or **read_application_reports**.



```php
$response = $report->list($options);
```

##### Get a Report (GET /topics/:topic_id/reports/:id)

Retrieve a specific report on the associated topic by Id. Requires authorization of **read_any_reports**, or **read_application_reports**.



```php
$response = $report->find($options);
```

##### Create a Report (POST /topics/:topic_id/reports)

Create a new report on the associated Topic which can be easily retrieved later using an id. Requires authorization of **manage_any_reports**, or **manage_application_reports**.

The following arguments are required:

 * __report__: A Hash containing `name`: The name of the report (required).`query`:The search query acccording to the [elasticsearch Query DSL](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-queries.html) to filter the data for the facets (Defaults to match all).`facets`:An array of facet hashes which each contain a `name` ad type of the facet along with its query hash (required).

```php
$response = $report->create("{name:'My report', query:{match_all: { }}, facets:[{name: 'facet1', type: 'terms', query: { field: 'value1'}}]}", $options);
```

##### Update a Report for a Topic (PUT /topics/:topic_id/reports/:id)

Update the query, facets or name of the report. Requires authorization of **manage_any_reports**, or **manage_application_reports**.

The following arguments are required:

 * __report__: A Hash containing `name`: The name of the report (required).`query`:The search query acccording to the [elasticsearch Query DSL](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl-queries.html) to filter the data for the facets (Defaults to match all).`facets`:An array of facet hashes which each contain a `name` ad type of the facet along with its query hash (required).

```php
$response = $report->update("{name:'My report', query:{match_all: { }}, facets:[{name: 'facet1', type: 'terms', query: { field: 'value1'}}]}", $options);
```

##### Delete a Report (DELETE /topics/:topic_id/reports/:id)

Remove a saved report on the associated Topic by Id. Requires authorization of **manage_any_reports**, or **manage_application_reports**.



```php
$response = $report->delete($options);
```

### Subscription api

Subscriptions allows feed data to imported using a socket rather than just using the Feed REST API. By creating a subscription sensit will start to listen for feed data being imported using the specified `host` and while using the topic name as the `channel` name.

The following arguments are required:

 * __id__: The identifier for the subscription

```php
$subscription = $client->subscription("subscription1");
```

##### List of Subscriptions (GET /subscriptions)

Get the list of all subscriptions for importing feed data to the associated topics. Requires authorization of **read_any_subscriptions**, or **read_application_subscriptions**.



```php
$response = $subscription->list($options);
```

##### Get a Subscription (GET /subscriptions/:id)

Get the information of a specific subscription. Requires authorization of **read_any_subscriptions**, or **read_application_subscriptions**.



```php
$response = $subscription->find($options);
```

##### Create a Subscription (POST /subscriptions)

Create a subscription which will connect to the server and listen for feed data for any of the associated topics. Requires authorization of **manage_any_subscriptions**, or **manage_application_subscriptions**.

The following arguments are required:

 * __subscription__: A Hash containing`name`:The channel or name to identify the subscription(required).`host`:The ip address or host of the connection(required).`protocol`:the protocol to communicate over (http, tcp, udp, mqtt) (required)`port`:The port of the connection.

```php
$response = $subscription->create("{name:'alpha', host:'10.234.12.11', protocol:'http', port:80}", $options);
```

##### Update a Subscription (PUT /subscriptions/:id)

Returns an object with the current configuration that Buffer is using, including supported services, their icons and the varying limits of character and schedules.  Requires authorization of **manage_any_subscriptions**, or **manage_application_subscriptions**.

The following arguments are required:

 * __subscription__: A Hash containing`name`:The channel or name to identify the subscription(required).`host`:The ip address or host of the connection(required).`protocol`:the protocol to communicate over (http, tcp, udp, mqtt) (required)`port`:The port of the connection.

```php
$response = $subscription->update("{name:'alpha', host:'10.234.12.11', protocol:'http', port:80}", $options);
```

##### Delete a Subscription (DELETE /subscriptions/:id)

Delete the subscription and stop listening for feed data for the associated topics. Requires authorization of **manage_any_subscriptions**, or **manage_application_subscriptions**.



```php
$response = $subscription->delete($options);
```

### Field api

.

The following arguments are required:

 * __topic_id__: The key for the parent topic
 * __id__: Username of the user

```php
$field = $client->field("pksunkara", "my_topic");
```

##### List all Fields for a Topic (GET /topics/:topic_id/fields)

Get all the fields associated with a topic. Requires authorization of **read_any_data**, or **read_application_data**



```php
$response = $field->list($options);
```

##### Get a Field (GET /topics/:topic_id/fields/:id)

Get a Field of the associated a topic and Id. Requires authorization of **read_any_data**, or **read_application_data**



```php
$response = $field->find($options);
```

##### Create a Field on a Topic (POST /topics/:topic_id/fields)

Adds a new field that feed data can be added too. Requires authorization of **manage_any_data**, or **manage_application_data**

The following arguments are required:

 * __field__: A Hash containing`name`: A descriptive name of the field.`key`:The name that is used to identify the field in a feed (required).`datatype`:The type of data that is stored in the field. ie. integer, float, string, bool, datetime

```php
$response = $field->create("{name:'Transaction ID', key:'tran_id', datatype:'integer'}", $options);
```

##### Update a Field on a Topic (PUT /api/topics/:topic_id/fields/:id)

Updates the Field data and makes the corresponding changes in the index. Requires authorization of **manage_any_data**, or **manage_application_data**

The following arguments are required:

 * __field__: A Hash containing`name`: A descriptive name of the field.`key`:The name that is used to identify the field in a feed (required).`datatype`:The type of data that is stored in the field. ie. integer, float, string, bool, datetime

```php
$response = $field->update("{name:'Transaction ID', key:'tran_id', datatype:'integer'}", $options);
```

##### Delete a Field of the associated Topic. (DELETE /api/topics/:topic_id/fields/:id)

Deletes a field and the feed data in that field. Requires authorization of **manage_any_data**, or **manage_application_data**



```php
$response = $field->delete($options);
```

## Contributors
Here is a list of [Contributors](https://github.com/cwadding/sensit-php/contributors)

### TODO

## License
MIT

## Bug Reports
Report [here](https://github.com/cwadding/sensit-php/issues).

## Contact
Christopher Waddington (cwadding@gmail.com)
